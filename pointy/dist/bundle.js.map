{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./lib/pillbug.js","webpack:///./src/index.js","webpack:///./src/menu.js","webpack:///./src/modal-yes-no.js","webpack:///./src/page-container.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;AAGA;;AAEA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,uB;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;;;AAGO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;AAGO;AACP;AACA;;;AAGO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGO;AACP;AACA,cAAc,OAAO;AACrB;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,wBAAwB,KAAK;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpVA;AAAA;AAAA;AAAA;AAAA;AAA8D;AACpC;AACmB;AACL;;AAExC;;AAEA,gBAAgB,mDAAG;AACnB,gBAAgB,8DAAc;AAC9B,iBAAiB,sDAAM;AACvB,WAAW,GAAG;AACd;;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAAS,6CAAI;;;;;;;;;;;;;ACnBb;AAAA;AAAA;AAA0C;;;AAG3B,mBAAmB,oDAAI;AACtC;AACA,6CAA6C;AAC7C,mCAAmC,SAAS,eAAe;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA,KAAK;AACL;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA,C;;;;;;;;;;;;AC/BA;AAAA;AAAA;AAA2C;;;AAG5B,yBAAyB,qDAAK;AAC7C;AACA;AACA;AACA;AACA;AACA,iCAAiC,8BAA8B;AAC/D,qCAAqC,uCAAuC;AAC5E;AACA;AACA;;;;;;;;;;;;;ACbA;AAAA;AAAA;AAA0C;;AAE3B,4BAA4B,oDAAI;AAC/C;AACA;AACA;AACA;AACA,C","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","/*\nPillbug version 0.0.1\n\n\n*/\n\nconst c = console;\nexport class App {\n  constructor() {\n    this._eventWatchers = {}\n    this._views = {}\n  }\n  view(cls, name) {\n    let view = new cls(this)\n    if (name) {\n      this._views[name] = view\n    }\n  }\n  emit(event, data) {\n    this._watchers(event).forEach(w => w(data))\n  }\n  on(event, callback) {\n    this._watchers(event).push(callback)\n  }\n  _watchers(event) {\n    let watchers = this._eventWatchers[event]\n    if (watchers == undefined) {\n      watchers = []\n      this._eventWatchers[event] =  watchers\n    }\n    return watchers\n  }\n}\n\nexport class ModalContainer {\n  constructor(id) {\n    this._el = h('#' + id)\n  }\n  showModal(modal) {\n    this._el.inner(modal)\n    return modal.promise\n      .then(result => {          \n        this._el.clear()\n        return result\n      })\n      .catch(error => {\n        this._el.clear()\n        return error\n      })\n  }\n}\n\n\nexport class View {\n  constructor(app, props, key) {\n    this._app = app\n    this._key = key\n    this._vCache = {}\n    this._matchers = {}\n    this._vals = {}\n    this.v = this._view.bind(this)\n    this.draw(h, this.v, app, props, key, this)\n  }\n  wrap(v) {\n    /*\n    if (el instanceof NodeWrapper || el instanceof View) {\n      this.root = el\n      this.el = el.el\n    } else {\n      throw new TypeError(\"View.wrap() only accepts types: NodeWrapper, View\")\n    }\n    */\n    this.root = v\n    this.el = v.el\n    return v\n  }\n  match(prop, fn) {\n    if (!this._matchers.hasOwnProperty(prop)) {\n      this._matchers[prop] = []\n    }\n    this._matchers[prop].push(fn)\n  }\n  update(props) {\n    this._update(h, this.v, this._app, props, this._key, this)\n  }\n  _update(h,v,a,p,k,s) {\n    for (let prop in s._matchers) {\n      let val = p[prop];\n      if (s._vals[prop] !== val) {\n        s._matchers[prop].forEach(fn => {\n          fn(val, p)\n        })\n      }\n      s._vals[prop] = val\n    }\n  }\n  _view(cls, props, key) {\n    let view;\n    if (key == undefined) {\n      view = new cls(this._app, props)\n    } else {\n      let className = cls.name;\n      if (!this._vCache.hasOwnProperty(className)) {\n        this._vCache[className] = {}\n      }\n      let cacheForType = this._vCache[className];\n      if (cacheForType.hasOwnProperty(key)) {\n        view = cacheForType[key]\n      } else {\n        view = new cls(this._app, props, key)\n        cacheForType[key] = view\n      }\n    }\n    view.update(props)\n    return view\n  }\n}\n\n\nexport class Modal extends View {\n  draw(h,v,a,p,k,s) {\n    s.wrap(s.overlay(h,v,a,p,k,s).on({\n      click: e => {\n        if (e.target == s.el) {\n          s.reject('user-cancelled')\n        }\n      }\n    }))\n    s.promise = new Promise((resolve, reject) => {\n      s.resolve = resolve\n      s.reject = reject\n    })\n    s.root.inner(s.content(h,v,a,p,k,s))\n  }\n}\n\n\nexport function h(tag) {\n  return new NodeWrapper(tag)\n}\n\n\nexport class NodeWrapper {\n  constructor(tag) {\n    if (tag.startsWith('#')) {\n      this.el = document.getElementById(tag.substr(1))\n    } else {\n      this.el = document.createElement(tag)\n    }\n  }\n  atts(atts) {\n    for (let key in atts) {\n      this.el.setAttribute(key, atts[key])\n    }\n    return this\n  }\n  checked(val) {\n    this.el.checked = val\n    return this\n  }\n  class(className) {\n    /*\n    classList.add(\"mystyle\")\n    element.classList.toggle(\"mystyle\")\n    .remove(\"mystyle\")\n    */\n    this.el.className = className\n    return this\n  }\n  clear() {\n    this.el.innerHTML = ''\n    return this\n  }\n  on(event, callback) {\n    this.el.addEventListener(event, callback)\n    return this\n  }\n  id(id) {\n    this.el.id = id\n    return this\n  }\n  inner(inner) {\n    this.el.innerHTML = ''\n    if (!Array.isArray(inner)) {\n      inner = [inner]\n    }\n    let fragment = document.createDocumentFragment()\n    inner.forEach(child => {\n      if (child instanceof NodeWrapper || child instanceof View) {\n        fragment.appendChild(child.el)\n      } else if (child instanceof Node) {\n        fragment.appendChild(child)\n      } else {\n        fragment.appendChild(document.createTextNode(child.toString()))\n      }\n    })\n    this.el.appendChild(fragment)\n    return this\n  }\n  html(html) {\n    this.el.innerHTML = html\n    return this\n  }\n  text(text) {\n    this.el.textContent = text\n    return this\n  }\n}\n\n/*\n\nRouting.\n\nkey won't work if no args, but we want it to!\n\nparams vs vars\n*/\n\nexport class Router {\n  constructor() {\n    this.routes = [];\n    window.addEventListener('hashchange', e => this._hashChanged());\n    window.addEventListener('load', e => this._hashChanged());\n    /*\n    //window.addEventListener('load', router);\n    window.addEventListener('popstate', () => {\n     contentDiv.innerHTML = routes[window.location.pathname];\n    }\n    */\n  }\n  add(pattern, cls, key) {\n    this.routes.push(new Route(pattern, cls, keyFn))\n  }\n  _hashChanged(e) {\n    let url = location.hash.slice(1) || '/';\n    let route = this._getRoute(url);\n    if (!route) {\n      throw new Error('Route not matched: ' + url)\n    }\n    //window.history.pushState({}, url, window.location.origin + url);\n  }\n  _goto(url) {\n\n  }\n  _getRoute(url) {\n    let len = this.routes.length;\n    for (let i=0; i<len; i++) {\n      let route = this.routes[i];\n      if (route.matches(url)) {\n        return route\n      }\n    }\n  }\n}\n\n\nexport class Route {\n  constructor(pattern, cls, keyFn) {\n    //'todos/{id:int}?name,age'\n    let paramStr;\n    this.cls = cls;\n    this.keyFn = keyFn; //TODO - implement/use\n    [pattern, paramStr] = pattern.split('?')\n    this.pattern = pattern\n    this.chunks = pattern.split('/').map(s => {\n      if (s.startsWith('{')) {\n        return new RouteArg(s.slice(1,-1))\n      }\n      return s\n    })\n    this.params = {}\n    if (paramStr) {\n      paramStr.split(',').forEach(s => {\n        let r = new RouteArg(s.trim());\n        this.params[r.name] = r;\n      })\n    }\n  }\n  /*\n  _extract(str) {\n    return str.match(/\\{.+?\\}/g).map(x => x.slice(1,-1))\n  }\n  */\n  match(url) {\n    let main, paramStr, chunks;\n    [main, paramStr] = url.split('?')\n    chunks = main.split('/')\n    let defChunk, testChunk, props = {}, i=0, end=this.chunks.length, mismatch=false;\n    if (end == chunks.length) {\n      while (true) {\n        defChunk = this.chunks[i];\n        testChunk = chunks[i];\n        if (defChunk instanceof RouteArg) {\n          props[defChunk.name] = defChunk.convert(testChunk)\n        } else if (defChunk !== testChunk) {\n          mismatch = true;\n          break;\n        }\n        i ++;\n        if (i > end) {\n          break;\n        }\n      }\n      if (!mismatch) {\n        if (paramStr) {\n          paramStr.split('&').forEach(e => {\n            let k, v;\n            [k,v] = e.split('=')\n            if (this.params.hasOwnProperty(k)) {\n              props[k] = this.params[k].convert(v)\n            }\n          })\n        }\n        return props\n      }\n    }\n    return false\n  }\n}\n\nexport class RouteArg {\n  constructor(str) {\n    // No error checks :-(\n    let name, conv;\n    [name, conv] = str.split(':')\n    this.name = name\n    switch (conv) {\n      case 'int':\n        this.conv = v => parseInt(v);\n        break;\n      case 'float':\n        this.conv = v => parseFloat(v);\n        break;\n      default:\n        this.conv = v => v;\n    }\n  }\n  convert(val) {\n    return this.conv(val)\n  }\n}\n","import {App, ModalContainer, Router} from '../lib/pillbug.js';\nimport Menu from './menu';\nimport PageContainer from './page-container';\nimport ModalYesNo from './modal-yes-no';\n\nconst c = console;\n\nconst app = new App()\napp.modal = new ModalContainer('modal-container')\napp.router = new Router([\n  ['todos/{id}?name,age', ''],\n])\n\napp.goto = function(route) {\n  // so far not used as we use hrefs\n  //this.emit('goto', page)\n}\napp.showModal = app.modal.showModal;\n\napp.view(Menu)\n","import {View, h} from '../lib/pillbug.js';\n\n\nexport default class Menu extends View {\n  draw(h,v,a,p,k,s) {\n    let showMenuBtn = h('span').html('&#9776;').class('menu-button').on('click', e => s.showMenu())\n    let hideMenuBtn = h('a').atts({href:\"#\"}).html('&times;').class('closebtn').on('click', e => s.hideMenu())\n    s.menuDiv = h('div').id('menu').class('overlay').inner([\n      hideMenuBtn,\n      h('div').class('overlay-content').inner([\n        s.getMenuEntry(a, h, 'Page1', 'page1'),\n        s.getMenuEntry(a, h, 'Page2', 'page2')\n        ])\n      ])\n    s.wrap(h('#menu-container')).inner([\n      s.menuDiv, \n      showMenuBtn\n      ])\n  }\n  getMenuEntry(a, h, text, route) {\n    return h('a').atts({href:\"#/\" + route}).text(text).on('click', e => {\n      this.hideMenu()\n      //a.goto(route)\n    })\n  }\n  showMenu() {\n    this.menuDiv.atts({style: 'width: 70%'})\n  }\n  hideMenu() {\n    this.menuDiv.atts({style: 'width: 0'})\n  }\n}","import {Modal, h} from '../lib/pillbug.js';\n\n\nexport default class ModalYesNo extends Modal {\n  overlay(h,v,a,p,k,s) {\n    return h('div').class('modal-background')\n  }\n  content(h,v,a,p,k,s) {\n    return h('div').class('modal-content modal-animate').inner([\n      h('button').text('OK').on({click: e => s.resolve(222521)}),\n      h('button').text('Cancel').on({click: e => s.reject('user-cancelled')}),\n    ])\n  }\n}\n","import {View, h} from '../lib/pillbug.js';\n\nexport default class PageContainer extends View {\n  draw(h,v,a,p,k) {\n    this.wrap(h('#page-container')).inner(p)\n    a.on('goto', page => this.root.inner(page))\n  }\n}"],"sourceRoot":""}