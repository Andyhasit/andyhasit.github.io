c=console;var h=mop.html;const atts={pageContainer:{id:"page-container"},modalBackground:{class:"modal-background"},menuEntries:{class:"overlay-content"},modalContent:{class:"modal-content modal-animate"}};class TodoList extends mop.Box{render(){var t=this._data.map(t=>this._(TodoItem,t));return h.div({},h.ul({},t))}}class TodoItem extends mop.Box{render(){let t,e=this._data.text;switch(e[0]){case"r":t="red";break;case"b":t="blue";break;case"y":t="yellow";break;case"g":t="green";break;default:t="black"}return h.li({style:`color: ${t}`},e)}}class Page extends mop.Box{constructor(t){super(),this.route=t.route,this.name=t.name}render(){let t=app.currentPage==this.route?Page.attsVisible:Page.attsHidden;return h.div(t,this.name)}}Page.trackBy="route",Page.attsHidden={style:"display: none; padding: 20px"},Page.attsVisible={style:"display: block; padding: 20px"};class DayView extends mop.Box{constructor(t){super(),this.day=t.day}render(){return h.div({},[h.h3({},this.day),h.div({},"dd")])}}DayView.trackBy="day";class HomePage extends Page{constructor(t){super(t),this.text="",this.todos=[]}addToDo(t){this.todos.push({id:this.todos.length+1,text:this.text}),this.text="",this.flush(!0)}renderAddBtn(){return h.button({},"Add",{click:()=>this.addToDo("yo")})}renderInput(){let t=this;return h.input({value:this.text},null,{keyup:function(e){t.setText(e)}})}setText(t){t.preventDefault(),13==t.keyCode?this.addToDo():this.text=t.target.value}render(){let t=app.currentPage==this.route?Page.attsVisible:Page.attsHidden;return h.div(t,[h.h1({},this.name),this.renderInput(),this.renderAddBtn(),this._(TodoList,this.todos)])}}HomePage.trackBy="route";class Modal extends mop.Box{constructor(t){super(t),this.promise=new Promise((t,e)=>{this._resolveFn=t,this._rejectFn=e})}resolveModal(t){this._resolveFn(t)}rejectModal(t){this._rejectFn(t)}push(){this._dirty=!0}formField(t,e,n){return h.label({for:""},[h.b({},e),h.input({type:"text",placeholder:n,name:t})])}okButton(){return h.button({type:"button",class:"btn-ok btn-modal-submit"},"OK",{click:t=>this.resolveModal(222)})}cancelButton(){return h.button({type:"button",class:"btn-cancel"},"Cancel",{click:t=>this.rejectModal("user-cancelled")})}render(){let t={click:t=>{t.target==this.element&&this.rejectModal("user-cancelled")}};return h.div(atts.modalBackground,this.renderContent(),t)}}class Modal1 extends Modal{renderContent(){return h.form(atts.modalContent,[this.formField("username","Username","Bob"),this.okButton(),this.cancelButton()])}}class PageContainer extends mop.Box{push(){this._dirty=!0}renderGoBtn(t,e){return h.button({},e.day,{click:()=>app.goto(t,e)})}renderDayBtns(){return app.days.map(t=>this.renderGoBtn(DayView,t))}render(){return h.div({},[h.button({},"show",{click:()=>mop.showModal(Modal1,{}).then(t=>{c.log(t),app.flush()}).catch(t=>{})}),h.div(atts.pageContainer,this.renderDayBtns()),h.div({},app.currentPage)])}}class MenuEntry extends mop.Box{constructor(t){super(),this.route=t.route,this.name=t.name}render(){return h.a({href:"#",onclick:"app.showSection('"+this.route+"')"},this.name)}}MenuEntry.trackBy="route";class Menu extends mop.Box{renderAtts(){return{id:"menu",class:"overlay",style:"width: "+(app.menuOpen?"70%":"0%")}}render(){var t=app.menuEntries.map(t=>this._(MenuEntry,t));return h.div(this.renderAtts(),[h.a({href:"#",class:"closebtn",onclick:"app.hideMenu()"},"&times;"),h.div(atts.menuEntries,t)])}}class MenuBar extends mop.Box{render(){c.log(this);let t={click:function(t){app.showMenu()}};return h.div({},[this._(Menu),h.span({class:"menu-button"},"&#9776;",t)])}}mop.render=function(){return h.div({},[this._(MenuBar),this._(mop.ModalContainer),this._(PageContainer)])},mop._modalContainer=new mop.ModalContainer("modal-container"),mop.showModal=function(t,e){return this._modalContainer.showModal(t,e)};const app=mop;app.currentPage="home",app.menuEntries=[{cls:HomePage,route:"home",name:"Sophie holiday list"},{cls:HomePage,route:"page2",name:"Page2"}],app.action("showMenu",function(){c.log(88),this.menuOpen=!0}),app.action("hideMenu",function(){this.menuOpen=!1}),app.action("showSection",function(t){this.currentPage=t,this.menuOpen=!1}),app.action("goto",function(t,e){this.currentPage=this._(t,e)}),app.load=function(){mop.element=document.getElementById("app"),lsd.delete("mop-todos");const t=new lsd.Schema;t.addVersion(t=>{let e=t.addStore("day");e.put({day:"mon"}),e.put({day:"tue"}),e.put({day:"wed"});let n=t.addStore("task");n.put({text:"Breadkfast"}),n.put({text:"Lunch"}),n.put({text:"Dinner"}),t.oneToMany("day","task")}),this.db=new lsd.Database("mop-todos",t),this.db.getAll("task").then(t=>{this.tasks=t,this.db.getAll("day").then(t=>{this.days=t,this.db.setParent("task","day",this.tasks[1],this.days[1].id).then(t=>{this.db.getChildren("day","task",this.days[1].id).then(t=>c.log(t)),this.db.getParent("task","day",this.tasks[1]).then(t=>c.log(t)),this.db.getParent("task","day",this.tasks[0]).then(t=>c.log(t))}),this._redraw(),this.flush()})})};