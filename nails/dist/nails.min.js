function BoxRegister(){this._types={},this._reg={}}function copyProps(t,e){for(var o in t)e[o]=t[o]}function Box(t){for(var e in this.dirty=!0,this._nestedBoxes=[],t)this[e]=t[e]}BoxRegister.prototype.new=function(e,t,o){var n=this;this._types[e]=function(){};var i=this._types[e];copyProps(Box.prototype,i.prototype),t.forEach(function(t){copyProps(n._types[t].prototype,i.prototype)}),copyProps(o,i.prototype),this[e]=function(){var t=new this._types[e];return Box.call(t),t.init.apply(t,arguments),t}};var box=Box.prototype;function UiUtils(t,e){e.forEach(function(o){t[o]=function(){return new VirtualNode(o,arguments[0],(t=arguments,1==(e=Array.prototype.slice.call(t,1)).length?e[0]:e));var t,e}})}function VirtualNode(t,e,o){this.tag=t.toUpperCase(),this.inner=o,this.atts=e}Box.prototype.isBox=!0,Box.prototype.init=function(){},Box.prototype.ping=function(e,o){this.shouldRedraw(e,o)&&this.redraw(e,o),this._nestedBoxes.forEach(function(t){t.ping(e,o)})},Box.prototype.shouldRedraw=function(t,e){return this.dirty||!0},Box.prototype.isActive=function(){return!0},Box.prototype.redraw=function(t,e){var o=this.render();null==this.element&&(this.element=document.createElement(o.tag)),this._nestedBoxes.length=0,this.applyChanges(this.element,o,this._nestedBoxes),this.dirty=!1},Box.prototype.setAttributes=function(t,e){for(var o in e)t.setAttribute(o,e[o])},Box.prototype.applyChanges=function(t,e,o){var n,i,r=this,s=e.inner;c.log(t),this.setAttributes(t,e.atts),Array.isArray(s)?(i=document.createDocumentFragment(),s.forEach(function(t){t.isBox?(null==t.element?t.redraw():o.push(t),n=t.element):t.isVirtualNode?(n=document.createElement(t.tag),r.applyChanges(n,t,o)):n=document.createTextNode(t),c.log(n),i.appendChild(n)}),t.innerHTML="",t.appendChild(i)):void 0!==s&&s.isVirtualNode?r.applyChanges(t,s,o):t.innerHTML=s},ViewModel=function(){this.watchers=[],this.changes=[]},ViewModel.prototype.flush=function(){var e=this;this.watchers.forEach(function(t){t.ping(e,changes)}),this.changes.length=[]},VirtualNode.prototype.isVirtualNode=!0;