function VirtualNode(t,e,o){this.tag=t.toUpperCase(),this.inner=o,this.atts=e}function Box(t){for(var e in this.dirty=!0,this.childBoxes=[],t)this[e]=t[e]}VirtualNode.prototype.isVirtualNode=!0;var box=Box.prototype;function UiUtils(t,e){e.forEach(function(o){t[o]=function(){return new VirtualNode(o,arguments[0],(t=arguments,1==(e=Array.prototype.slice.call(t,1)).length?e[0]:e));var t,e}})}Box.prototype.isBox=!0,Box.prototype.ping=function(e,o){this.shouldRedraw(e,o)&&this.redraw(e,o),this.activeBoxes().forEach(function(t){t.ping(e,o)})},Box.prototype.shouldRedraw=function(t,e){return this.dirty||!0},Box.prototype.activeBoxes=function(t,e){return this.childBoxes.filter(function(t){return t.isActive()})},Box.prototype.isActive=function(){return!0},Box.prototype.redraw=function(t,e){this.childBoxes.length=0,this.applyChanges(this.boundNode(),new VirtualNode(this.tag,this.atts(t,e),this.inner(t,e)),this.childBoxes),this.dirty=!1},Box.prototype.inner=function(t,e){return""},Box.prototype.atts=function(t,e){return{}},Box.prototype.boundNode=function(){return null==this.element&&(this.element=document.createElement(this.tag)),this.element},Box.prototype.setAttributes=function(t,e){for(var o in e)t.setAttribute(o,e[o])},Box.prototype.applyChanges=function(t,e,o){var i=this;this.setAttributes(t,e.atts);var n=e.inner;if(Array.isArray(n)){t.innerHTML="";var r=document.createDocumentFragment();n.forEach(function(t){if(t.isBox){var e=t.boundNode();o.push(t)}else if(t.isVirtualNode){e=document.createElement(t.tag);i.applyChanges(e,t,o)}else e=document.createTextNode(t);r.appendChild(e)}),t.appendChild(r)}else void 0!==n&&n.isVirtualNode?i.applyChanges(t,n,o):t.innerHTML=n},ViewModel=function(){this.watchers=[],this.changes=[]},ViewModel.prototype.flush=function(){var e=this;this.watchers.forEach(function(t){t.ping(e,changes)}),this.changes.length=[]};